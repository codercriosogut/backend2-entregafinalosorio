Adjunto el codigo completo:

directorio:
ðŸ“¦src
 â”£ ðŸ“‚controllers
 â”ƒ â”£ ðŸ“œbusiness.controller.js
 â”ƒ â”£ ðŸ“œorders.controller.js
 â”ƒ â”— ðŸ“œusers.controller.js
 â”£ ðŸ“‚dao_dto
 â”ƒ â”£ ðŸ“‚classes
 â”ƒ â”ƒ â”£ ðŸ“œbusiness.dao.js
 â”ƒ â”ƒ â”£ ðŸ“œbusiness.dto.js
 â”ƒ â”ƒ â”£ ðŸ“œorder.dao.js
 â”ƒ â”ƒ â”£ ðŸ“œorder.dto.js
 â”ƒ â”ƒ â”£ ðŸ“œticket.dao.js
 â”ƒ â”ƒ â”£ ðŸ“œticket.model.js
 â”ƒ â”ƒ â”£ ðŸ“œuser.dao.js
 â”ƒ â”ƒ â”— ðŸ“œuser.dto.js
 â”ƒ â”— ðŸ“‚models
 â”ƒ â”ƒ â”£ ðŸ“œbusiness.model.js
 â”ƒ â”ƒ â”£ ðŸ“œorder.model.js
 â”ƒ â”ƒ â”— ðŸ“œuser.model.js
 â”£ ðŸ“‚repositories
 â”ƒ â”— ðŸ“œorder.repository.js
 â”£ ðŸ“‚routes
 â”ƒ â”£ ðŸ“œbusiness.router.js
 â”ƒ â”£ ðŸ“œorders.router.js
 â”ƒ â”— ðŸ“œusers.router.js
 â”£ ðŸ“œapp.js
 â”— ðŸ“œmiddlewares.js


src/app.js
import express from 'express';
import cors from 'cors';
import usersRouter from './routes/users.router.js';
import ordersRouter from './routes/orders.router.js';
import businessRouter from './routes/business.router.js';
import mongoose from 'mongoose';
import nodemailer from 'nodemailer';
import dotenv from 'dotenv';
/* import { authMiddleware } from './middlewares.js'; */

dotenv.config();

const app = express();
const PORT = 8080;

if (!process.env.EMAIL_USER || !process.env.EMAIL_PASS) {
    console.error('Error: ConfiguraciÃ³n de correo no definida en las variables de entorno');
    process.exit(1);
}

const transport = nodemailer.createTransport({
    service: "gmail",
    auth: {
        user: process.env.EMAIL_USER,
        pass: process.env.EMAIL_PASS
    }
});

export { transport };

mongoose.connect(process.env.MONGODB_URI)
    .then(() => {
        console.log('ConexiÃ³n a MongoDB establecida');
        app.listen(PORT, () => {
            console.log(`Server is running on port ${PORT}`);
        });
    })
    .catch(error => {
        console.error('Error al conectar a MongoDB:', error);
        process.exit(1); // Detener el proceso si falla la conexiÃ³n
    });

app.use(cors());
app.use(express.json());
app.use(express.urlencoded({ extended: true }));

app.use('/api/users', usersRouter);
app.use('/api/business', businessRouter);
app.use('/api/orders', ordersRouter);

app.listen(PORT, () => {
    console.log(`Server is running on port ${PORT}`);
});












src/middlewares.js
import jwt from 'jsonwebtoken';

export const authMiddleware = (req, res, next) => {
    let token = req.headers['authorization'];

    if (!token) {
        return res.status(403).send({ status: 'error', error: 'No token provided' });
    }

    // Verifica si el token contiene el prefijo "Bearer "
    if (token.startsWith('Bearer ')) {
        token = token.slice(7, token.length); // Elimina "Bearer " del token
    }

    jwt.verify(token, process.env.JWT_SECRET, (err, decoded) => {
        if (err) {
            const message = err.name === 'TokenExpiredError' ? 'Token has expired' : 'Invalid token';
            return res.status(403).send({ status: 'error', error: message });
        }
        req.user = decoded;
        next();
    });

};























src/controllers/business.controller.js
import Business from '../dao_dto/classes/business.dao.js';
import mongoose from 'mongoose';
import { BusinessDTO } from '../dao_dto/classes/business.dto.js';

const businessService = new Business();

export const getBusiness = async (req, res) => {
    let result = await businessService.getBusiness();
    if (!result) return res.status(500).send({ status: "error", error: "Something went wrong" });
    const businessDTO = result.map(b => new BusinessDTO(b));
    res.send({ status: "success", result: businessDTO });
};

export const getBusinessById = async (req, res) => {
    const { bid } = req.params;
    let result = await businessService.getBusinessById(bid);
    if (!result) return res.status(500).send({ status: "error", error: "Something went wrong" });
    const businessDTO = new BusinessDTO(result);
    res.send({ status: "success", result: businessDTO });
};

export const createBusiness = async (req, res) => {
    const business = req.body;
    let result = await businessService.saveBusiness(business);
    if (!result) return res.status(500).send({ status: "error", error: "Something went wrong" });
    const businessDTO = new BusinessDTO(result);
    res.send({ status: "success", result: businessDTO });
};

export const addProduct = async (req, res) => {
    let product = req.body;
    product.id = new mongoose.Types.ObjectId();  // Asignamos un nuevo ObjectId al producto
    
    // Obtenemos el negocio por su ID
    let business = await businessService.getBusinessById(req.params.bid);
    
    // Verificamos si el producto ya existe en el negocio
    const productExists = business.products.some(p => p.id.toString() === product.id.toString());
    if (productExists) {
        return res.status(400).send({ status: "error", message: "Product already exists in business" });
    }

    // Si el producto no existe, lo agregamos al negocio
    business.products.push(product);
    
    // Guardamos los cambios en la base de datos
    await businessService.updateBusiness(business._id, business);
    res.send({ status: "success", result: "Product added successfully to business" });
};


















src/controllers/orders.controller.js
import OrderRepository from '../repositories/order.repository.js';
import Business from '../dao_dto/classes/business.dao.js';
import User from '../dao_dto/classes/user.dao.js';
import { transport } from '../app.js';
import { OrderDTO } from '../dao_dto/classes/order.dto.js';

const orderRepository = new OrderRepository(); // Instancia del repositorio
const usersService = new User();
const businessService = new Business();

export const getOrders = async (req, res) => {
    try {
        const orders = await orderRepository.getOrders();
        const ordersDTO = orders.map(order => new OrderDTO(order));
        res.json({ status: 'success', orders: ordersDTO });
    } catch (error) {
        console.error(error);
        res.status(500).json({ message: 'Error al obtener las Ã³rdenes.' });
    }
};

export const getOrderById = async (req, res) => {
    const { oid } = req.params;
    try {
        const order = await orderRepository.getOrderById(oid);

        if (!order) {
            return res.status(404).send({ status: "error", error: "Order not found" });
        }

        const orderDTO = new OrderDTO(order);
        res.send({ status: "success", order: orderDTO });
    } catch (error) {
        console.error(error);
        res.status(500).send({ status: 'error', message: 'Error al obtener la orden.' });
    }
};

export const createOrder = async (req, res) => {
    const { userId, businessId, productIds } = req.body;

    if (!userId || !businessId || !productIds) {
        return res.status(400).send({ status: "error", error: "Missing required fields" });
    }

    try {
        const resultBusiness = await businessService.getBusinessById(businessId);
        const resultUser = await usersService.getUserById(userId);

        if (!resultBusiness || !resultUser) {
            return res.status(400).send({ status: "error", error: "User or Business not found" });
        }

        const actualOrders = resultBusiness.products.filter(product => productIds.includes(product.id.toString()));

        if (!actualOrders.length) {
            return res.status(400).send({ status: "error", error: "No valid products found" });
        }

        let totalPrice = actualOrders.reduce((acc, product) => acc + product.price, 0);
        let orderNumber = Date.now() + Math.floor(Math.random() * 10000 + 1);

        let order = {
            number: orderNumber,
            business: businessId,
            user: userId,
            products: actualOrders.map(product => ({
                id: product.id,
                name: product.name,
                price: product.price,
                quantity: product.quantity // AsegÃºrate de incluir la cantidad si la necesitas
            })),
            totalPrice,
            status: "pending"
        };

        let orderResult = await orderRepository.createOrder(order);
        resultUser.orders.push(orderResult._id);
        await usersService.updateUser(userId, resultUser);

        const orderDTO = new OrderDTO(orderResult);
        res.send({ status: "success", order: orderDTO });
    } catch (error) {
        console.error(error);
        res.status(500).send({ status: 'error', message: 'Error al crear la orden.' });
    }
};

export const resolveOrder = async (req, res) => {
    const { oid } = req.params;
    try {
        const order = await orderRepository.getOrderById(oid);

        if (!order) {
            return res.status(404).send({ status: "error", error: "Order not found" });
        }

        order.status = "resolved";
        await orderRepository.updateOrder(order._id, order);
        const orderDTO = new OrderDTO(order);
        res.send({ status: "success", order: orderDTO });
    } catch (error) {
        console.error(error);
        res.status(500).send({ status: 'error', message: 'Error al resolver la orden.' });
    }
};


export const sendOrderEmail = async (req, res) => {
    const { oid } = req.params;
    const order = await orderRepository.getOrderById(oid);

    if (!order) {
        return res.status(404).send({ status: "error", error: "Order not found" });
    }

    try {
        const result = await transport.sendMail({
            from: "Cristian Osorio <cosoriogut@gmail.com>",
            to: "cosoriogut@gmail.com", // Cambia esto al correo del usuario si corresponde
            subject: "Detalles de la Orden",
            html: `
                <div style="font-family: Arial, sans-serif; color: #333;">
                    <h1 style="background-color: #f8f9fa; padding: 10px; text-align: center;">Detalles de la Orden</h1>
                    <p>Â¡Gracias por tu pedido!</p>
                    <h2>Resumen de la Orden</h2>
                    <p><strong>NÃºmero de Orden:</strong> ${order.number}</p>
                    <p><strong>Estado:</strong> ${order.status}</p>
                    <p><strong>Total:</strong> $${order.totalPrice.toFixed(2)}</p>
                    <h3>Productos</h3>
                    <ul>
                        ${order.products.map(product => `
                            <li>
                                <strong>${product.name}</strong> - 
                                $${product.price.toFixed(2)} x ${product.quantity} unidad(es)
                            </li>
                        `).join('')}
                    </ul>
                    <hr>
                    <p style="text-align: center;">Â¡Gracias por comprar con nosotros!</p>
                </div>
            `,
            attachments: []
        });
        console.log('Correo enviado: ', result);
        res.send({ status: 'success', message: 'Email sent' });
    } catch (error) {
        console.error('Error al enviar el correo: ', error);
        res.status(500).send({ status: 'error', message: 'Failed to send email' });
    }
};



























src/controllers/users.controller.js
import User from '../dao_dto/classes/user.dao.js';
import { UserDTO } from '../dao_dto/classes/user.dto.js';

const userService = new User();

export const getUsers = async (req, res) => {
    try {
        let users = await userService.getUsers();
        const usersDTO = users.map(user => new UserDTO(user));
        res.send({ status: "success", users: usersDTO });
    } catch (error) {
        console.error(error);
        res.status(500).send({ status: "error", message: "Error al obtener los usuarios" });
    }
};


export const getUserById = async (req, res) => {
    const { uid } = req.params;
    let user = await userService.getUserById(uid);
    if (!user) return res.status(404).send({ status: "error", error: "User not found" });
    const userDTO = new UserDTO(user);
    res.send({ status: "success", user: userDTO });
};

export const createUser = async (req, res) => {
    const user = req.body;
    let result = await userService.saveUser(user);
    if (!result) return res.status(500).send({ status: "error", error: "Something went wrong" });
    const userDTO = new UserDTO(result);
    res.send({ status: "success", user: userDTO });
};



















src/dao_dto/classes/business.dao.js
import Business from '../models/business.model.js';

export default class BusinessDAO {
    async getBusiness() {
        return await Business.find({});
    }

    async getBusinessById(id) {
        try {
            return await Business.findById(id);
        } catch (error) {
            console.error(`Error al obtener el negocio por ID: ${error}`);
            throw new Error('Error fetching business');
        }
    }
    

    async saveBusiness(business) {
        const newBusiness = new Business(business);
        return await newBusiness.save();
    }

    async updateBusiness(id, business) {
        return await Business.findByIdAndUpdate(id, business, { new: true });
    }
}
















src/dao_dto/classes/business.dto.js
export class BusinessDTO {
    constructor(business) {
        this.id = business._id;
        this.name = business.name;
        this.products = business.products;
    }
}





























src/dao_dto/classes/order.dao.js
export class ProductDTO {
    constructor(product) {
        this.id = product.id;
        this.name = product.name;
        this.price = product.price;
        this.quantity = product.quantity;
    }
}

export class OrderDTO {
    constructor(order) {
        this.number = order.number;
        this.business = order.business;
        this.user = order.user;
        this.products = order.products.map(product => new ProductDTO(product));
        this.totalPrice = order.totalPrice;
        this.status = order.status;
    }
}


















src/dao_dto/classes/order.dto.js
export class OrderDTO {
    constructor(order) {
        this.id = order._id;
        this.number = order.number;
        this.business = order.business;
        this.user = order.user;
        this.products = order.products.map(product => ({
            id: product.id,
            name: product.name,
            price: product.price,
            quantity: product.quantity
        }));
        this.totalPrice = order.totalPrice;
        this.status = order.status;
    }
}

















src/dao_dto/classes/ticket.dao.js
import Ticket from '../models/ticket.model.js';

export default class TicketDAO {
    async createTicket(ticket) {
        const newTicket = new Ticket(ticket);
        return await newTicket.save();
    }

    async getTicketsByUserId(userId) {
        return await Ticket.find({ userId });
    }
}


















src/dao_dto/classes/ticket.model.js
import mongoose from 'mongoose';

const ticketSchema = new mongoose.Schema({
    orderId: { type: mongoose.Schema.Types.ObjectId, ref: 'Order' },
    userId: { type: mongoose.Schema.Types.ObjectId, ref: 'User' },
    status: { type: String, default: 'open' },
    createdAt: { type: Date, default: Date.now },
    updatedAt: { type: Date, default: Date.now }
});

export default mongoose.model('Ticket', ticketSchema);













src/dao_dto/classes/user.dao.js
import User from '../models/user.model.js';

export default class UserDAO {
    async getUsers() {
        return await User.find({});
    }

    async getUserById(id) {
        return await User.findById(id);
    }

    async saveUser(user) {
        const newUser = new User(user);
        return await newUser.save();
    }

    async updateUser(id, user) {
        return await User.findByIdAndUpdate(id, user, { new: true });
    }
}

















src/dao_dto/classes/user.dto.js
export class UserDTO {
    constructor(user) {
        this.id = user._id;
        this.name = user.name;
        this.email = user.email;
        this.orders = user.orders;
    }
}

















src/dao_dto/models/business.model.js
import mongoose from "mongoose";

const collection = "Business";

const schema = new mongoose.Schema({
    name: String,
    products: [{
        id: mongoose.SchemaTypes.ObjectId,
        name: String,
        price: Number
    }]
});

const businessModel = mongoose.model(collection, schema);

export default businessModel;


















src/dao_dto/models/order.model.js
import mongoose from 'mongoose';

const orderSchema = new mongoose.Schema({
    number: Number,
    business: { type: mongoose.Schema.Types.ObjectId, ref: 'Business' },
    user: { type: mongoose.Schema.Types.ObjectId, ref: 'User' },
    products: [{
        id: { type: mongoose.Schema.Types.ObjectId, ref: 'Product' },
        name: String,
        price: Number,
        quantity: Number
    }],
    totalPrice: Number,
    status: String
});

// AquÃ­ especificamos la colecciÃ³n como 'orders'
const Order = mongoose.model('Order', orderSchema, 'orders'); // 'orders' es el nombre de la colecciÃ³n
export default Order;












src/dao_dto/models/user.model.js
import mongoose from "mongoose";

const collection = "Users"

const schema = new mongoose.Schema({
    name: String,
    email: String,
    role: String,
    orders: [
        {
            type: mongoose.SchemaTypes.ObjectId,
            ref: "Orders"
        }
    ]
})

const userModel = mongoose.model(collection, schema)

export default userModel





















src/repositories/order.repository.js
import OrderDAO from '../dao_dto/classes/order.dao.js';

const orderDAO = new OrderDAO(); // Instancia del DAO

export default class OrderRepository {
    async getOrders() {
        return await orderDAO.getOrders();
    }

    async getOrderById(id) {
        return await orderDAO.getOrderById(id);
    }

    async createOrder(order) {
        return await orderDAO.createOrder(order);
    }

    async updateOrder(id, order) {
        return await orderDAO.updateOrder(id, order);
    }
}


















src/routes/business.router.js
import { Router } from "express";
import { getBusiness, getBusinessById, createBusiness, addProduct } from "../controllers/business.controller.js";

const router = Router()

router.get('/', getBusiness)
router.post('/', createBusiness)

router.get('/:bid', getBusinessById)
router.post('/:bid/product', addProduct)

export default router

















src/routes/orders.router.js
import { Router } from 'express';
import { getOrders, getOrderById, createOrder, resolveOrder, sendOrderEmail } from '../controllers/orders.controller.js';

const router = Router();

router.get('/', getOrders);
router.get('/:oid', getOrderById);
router.post('/', createOrder);
router.put('/:oid', resolveOrder);
router.get('/mail/order/:oid', sendOrderEmail);

export default router;


















src/routes/users.router.js
import { Router } from "express";
import { getUsers, getUserById, createUser } from '../controllers/users.controller.js'

const router = Router()

router.get('/', getUsers)
router.get('/:uid', getUserById)
router.post('/', createUser)

export default router













.env
EMAIL_USER=cosoriogut@gmail.com
EMAIL_PASS=ccbq crle ovlp xtra
JWT_SECRET=mySuperSecretKey123!@#
MONGODB_URI=mongodb+srv://cri2024:cri2024@cluster0.mswsapd.mongodb.net/clase13_EntregaFinal?retryWrites=true&w=majority&appName=Cluster0







.gitignore
node_modules
.env






package.json
{
  "name": "arquitectura-completo",
  "version": "1.0.0",
  "description": "",
  "main": "index.js",
  "type": "module",
  "scripts": {
    "start": "node --watch src/app.js"
  },
  "keywords": [],
  "author": "",
  "license": "ISC",
  "dependencies": {
    "cors": "^2.8.5",
    "dotenv": "^16.4.5",
    "express": "^4.19.2",
    "jsonwebtoken": "^9.0.2",
    "mongoose": "^8.3.2",
    "nodemailer": "^6.9.15"
  }
}

























































test Postman

## Directorios ##
```markdown
ðŸ“¦src
â”£ ðŸ“‚controllers
â”ƒ â”£ ðŸ“œbusiness.controller.js
â”ƒ â”£ ðŸ“œorders.controller.js
â”ƒ â”— ðŸ“œusers.controller.js
â”£ ðŸ“‚dao_dto
â”ƒ â”£ ðŸ“‚classes
â”ƒ â”ƒ â”£ ðŸ“œbusiness.dao.js
â”ƒ â”ƒ â”£ ðŸ“œbusiness.dto.js
â”ƒ â”ƒ â”£ ðŸ“œorder.dao.js
â”ƒ â”ƒ â”£ ðŸ“œorder.dto.js
â”ƒ â”ƒ â”£ ðŸ“œticket.dao.js
â”ƒ â”ƒ â”£ ðŸ“œticket.model.js
â”ƒ â”ƒ â”£ ðŸ“œuser.dao.js
â”ƒ â”ƒ â”— ðŸ“œuser.dto.js
â”ƒ â”— ðŸ“‚models
â”ƒ â”ƒ â”£ ðŸ“œbusiness.model.js
â”ƒ â”ƒ â”£ ðŸ“œorder.model.js
â”ƒ â”ƒ â”— ðŸ“œuser.model.js
â”£ ðŸ“‚routes
â”ƒ â”£ ðŸ“œbusiness.router.js
â”ƒ â”£ ðŸ“œorders.router.js
â”ƒ â”— ðŸ“œusers.router.js
â”£ ðŸ“œapp.js
â”— ðŸ“œmiddlewares.js
```

## Testing API ##

# 1.- Usuarios (/api/users)

### A.- Obtener todos los usuarios
- **MÃ©todo**: GET
- **URL**: `http://localhost:8080/api/users`
- **DescripciÃ³n**: Obtiene una lista de todos los usuarios.

#### Respuesta:
```json
{
    "status": "success",
    "users": [
        {
            "id": "6715ad2aab4efdd29fad77c0",
            "name": "cristian",
            "email": "cristian@correo.com",
            "orders": []
        }
    ]
}
```

### B.- Obtener un usuario por ID
- **MÃ©todo**: GET
- **URL**: `localhost:8080/api/users/6715ad2aab4efdd29fad77c0`
- **DescripciÃ³n**: Obtiene los detalles de un usuario especÃ­fico.
#### Respuesta:
```json
{
    "status": "success",
    "user": {
        "id": "6715ad2aab4efdd29fad77c0",
        "name": "cristian",
        "email": "cristian@correo.com",
        "orders": []
    }
}
```
### C.- Crear un nuevo usuario
- **MÃ©todo**: POST
- **URL**: `localhost:8080/api/users`
- **CUERPO**: (JSON)
- **DescripciÃ³n**: Obtiene los detalles de un usuario especÃ­fico.
#### Enviar:
```bash
{
    "name":"cristian",
    "email":"cristian@correo.com",
    "password": "mySuperSecretKey123!@#"
}
```
#### Respuesta:
```json
{
    "status": "success",
    "user": {
        "id": "6715ad2aab4efdd29fad77c0",
        "name": "cristian",
        "email": "cristian@correo.com",
        "orders": []
    }
}
```
##
# 2.- Negocios (/api/business)
##
### A.- Obtener todos los negocios
- **MÃ©todo**: GET
- **URL**: `localhost:8080/api/business`
- **DescripciÃ³n**: Obtiene una lista de todos los negocios.
#### Respuesta:
```json
{
    "status": "success",
    "result": [
        {
            "id": "6715af4b5845dafea6506c85",
            "name": "mi-empresa",
            "products": [
                {
                    "id": "6715b19a5845dafea6506c87",
                    "name": "procesador i7",
                    "price": 200000,
                    "_id": "6715b19a5845dafea6506c89"
                },
                {
                    "id": "6715b54eb19aaa59fe8d1330",
                    "name": "ram 16gb",
                    "price": 50000,
                    "_id": "6715b54eb19aaa59fe8d1333"
                }
            ]
        }
    ]
}
```
### B.- Obtener un negocio por ID
- **MÃ©todo**: GET
- **URL**: `localhost:8080/api/business/6715af4b5845dafea6506c85`
- **DescripciÃ³n**: Obtiene los detalles de un negocio especÃ­fico.
#### Respuesta:
```json
{
    "status": "success",
    "result": {
        "id": "6715af4b5845dafea6506c85",
        "name": "mi-empresa",
        "products": [
            {
                "id": "6715b19a5845dafea6506c87",
                "name": "procesador i7",
                "price": 200000,
                "_id": "6715b19a5845dafea6506c89"
            },
            {
                "id": "6715b54eb19aaa59fe8d1330",
                "name": "ram 16gb",
                "price": 50000,
                "_id": "6715b54eb19aaa59fe8d1333"
            }
        ]
    }
}
```
### C.- Crear un nuevo negocio
- **MÃ©todo**: POST
- **URL**: `localhost:8080/api/business`
- **CUERPO**: (JSON)
- **DescripciÃ³n**: Obtiene los detalles de un negocio especÃ­fico.
#### Enviar:
```bash
{
    "name": "mi-empresa",
    "products": []
}
```
#### Respuesta:
```json
{
    "status": "success",
    "result": {
        "id": "6715af4b5845dafea6506c85",
        "name": "mi-empresa",
        "products": []
    }
}
```
### D.- Agregar un producto a un negocio
- **MÃ©todo**: POST
- **URL**: `localhost:8080/api/business/6715af4b5845dafea6506c85/product`
- **CUERPO**: (JSON)
- **DescripciÃ³n**: Obtiene los detalles de un negocio especÃ­fico.
#### Enviar:
```bash
{
    "name": "procesador i7",
    "price": 200000,
    "quantity": 10
}
```
#### Respuesta:
```json
{
    "status": "success",
    "result": "Business updated"
}
```
##
# 3.- Ã“rdenes (/api/orders)
##
### A.- Obtener todas las Ã³rdenes
- **MÃ©todo**: GET
- **URL**: `localhost:8080/api/orders`
- **DescripciÃ³n**: Obtiene una lista de todas las Ã³rdenes.
#### Respuesta:
```json
{
    "status": "success",
    "orders": []
}
```
### B.- Obtener una orden por ID
- **MÃ©todo**: GET
- **URL**: `localhost:8080/api/orders/6715b7f0b19aaa59fe8d1354`
- **DescripciÃ³n**: Obtiene los detalles de una orden especÃ­fica.
#### Respuesta:
```json
{
    "status": "success",
    "order": {
        "id": "6715b7f0b19aaa59fe8d1354",
        "number": 1729476597052,
        "products": [
            {
                "name": "procesador i7",
                "price": 200000
            },
            {
                "name": "ram 16gb",
                "price": 50000
            }
        ],
        "totalPrice": 250000,
        "status": "pending"
    }
}
```
### C.- Crear una nueva orden
- **MÃ©todo**: POST
- **URL**: `http://localhost:8080/api/orders`
- **CUERPO**: (JSON)
- **DescripciÃ³n**: Obtiene los detalles de un negocio especÃ­fico.
#### Enviar:
```bash
{
    "userId": "6715ad2aab4efdd29fad77c0",
    "businessId": "6715af4b5845dafea6506c85",
    "productIds": ["6715b19a5845dafea6506c87", "6715b54eb19aaa59fe8d1330"]
}
```
#### Respuesta:
```json
{
    "status": "success",
    "orderResult": {
        "id": "6715b7f0b19aaa59fe8d1354",
        "number": 1729476597052,
        "products": [
            {
                "name": "procesador i7",
                "price": 200000
            },
            {
                "name": "ram 16gb",
                "price": 50000
            }
        ],
        "totalPrice": 250000,
        "status": "pending"
    }
}
```
### D.- Resolver una orden
- **MÃ©todo**: PUT
- **URL**: `localhost:8080/api/orders/6715b7f0b19aaa59fe8d1354`
- **DescripciÃ³n**: Marca una orden como resuelta.
#### Respuesta:
```json
{
    "status": "success",
    "order": {
        "id": "6715b7f0b19aaa59fe8d1354",
        "number": 1729476597052,
        "products": [
            {
                "name": "procesador i7",
                "price": 200000
            },
            {
                "name": "ram 16gb",
                "price": 50000
            }
        ],
        "totalPrice": 250000,
        "status": "resolved"
    }
}
```
### E.- Enviar correo con detalles de la orden
- **MÃ©todo**: GET
- **URL**: `localhost:8080/api/orders/mail/order/6715b7f0b19aaa59fe8d1354`
- **DescripciÃ³n**: EnvÃ­a un correo electrÃ³nico con los detalles de la orden.
#### Respuesta 1:
```json
{
    "status": "success",
    "message": "Email sent"
}
```
#### Respuesta 2:
```markdown
Correo enviado:  {
  accepted: [ 'cosoriogut@gmail.com' ],
  rejected: [],
  ehlo: [
    'SIZE 35882577',
    '8BITMIME',
    'AUTH LOGIN PLAIN XOAUTH2 PLAIN-CLIENTTOKEN OAUTHBEARER XOAUTH',
    'ENHANCEDSTATUSCODES',
    'PIPELINING',
    'CHUNKING',
    'SMTPUTF8'
  ],
  envelopeTime: 693,
  messageTime: 901,
  messageSize: 1592,
  response: '250 2.0.0 OK  1729477822 41be03b00d2f7-7eaeabdb784sm1882951a12.91 - gsmtp',
  envelope: { from: 'cosoriogut@gmail.com', to: [ 'cosoriogut@gmail.com' ] },
  messageId: '<2d412a42-3933-45e4-cc8b-33bd99201894@gmail.com>'
}

```
#### Respuesta 3:
```markdown
de:	Cristian Osorio <cosoriogut@gmail.com>
para:	cosoriogut@gmail.com
fecha:	20 oct 2024, 23:30
asunto:	Detalles de la Orden
enviado por:	gmail.com
Detalles de la Orden
Â¡Gracias por tu pedido!

Resumen de la Orden
NÃºmero de Orden: 1729476597052

Estado: resolved

Total: $250000.00

Productos
procesador i7 - $200000.00 x undefined unidad(es)
ram 16gb - $50000.00 x undefined unidad(es)
```